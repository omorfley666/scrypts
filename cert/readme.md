## Автоматическое создание сертификатов  

Для автоматического создания сертификатов (с центра сертификации) необходимо запустить скрипт [cert.sh](cert.sh) и проследовать дальнейшим шагам  

В результате срабатывания скрипта будут созданы файлы:  
* $hostname.crt - сертификат сервера, который необходимо импортировать (nginx)  
* $hostname.pfx - сертификат сервера, который необходим для IIS  
* $hostname.csr - файл запроса на подпись сертификата (остается на сервере)  
* $hostname.key - закрытый ключ (осатется на сервере)
* $hostname.ext - файл расширения x509 v3 (в нем хранится информация о хосте)  

Обратите внимание, что перед запуском скрипта в папке должны находиться файлы:  
- ca.crt
- ca.key
- ca.pem

Если этих файлов нет, то необходимо выписать сертификаты для ЦС с помощью:
1. Создайте закрытый ключ и самоподписанный сертификат  

```
openssl req -x509 -nodes -new -sha512 \
-days 365 -newkey rsa:4096 -keyout ca.key \
-out ca.pem -subj "/C=RU/CN=$company"
```
Примечание: замените $company на название вашей организации  

2. Создайте файл сертификата с расширением .crt:
```
openssl x509 -outform pem -in ca.pem -out ca.crt
```

В результате мы получим:  
* ca.crt - сертификат центра сертификации (устанавливается на машины клиентов), он подтвреждает информацию о центре сертификации, который выпустил сертифиат для сервера
* ca.key - закрытый ключ цетра сертификации (остается на сервере)  
* ca.pem - самоподписанный сертификат (необходим только для создания полноценного сертификата ca.crt) 